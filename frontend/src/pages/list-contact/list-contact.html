<!--
  Generated template for the ListContactPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->

<ion-header style="height: 50px;
  background-color: #E96FA1;">


  <ion-icon class="menuStyle" menuToggle name="menu"></ion-icon>

  <!-- 
  <ion-icon class="optionsStyle pop-in" [ngClass]="{ 'expand' : expanded, 'contract': contracted }" (click)="expand()"
    name="person-add"></ion-icon> -->

  <!-- <ion-icon (click)="presentContactFilter($event)" class="optionsStyle" style="margin-left: 10px; z-index: 1111" name="options">
      </ion-icon> -->

  <!-- <div (click)="openInvitationsList()">
    <ion-icon style="z-index:1111" class="optionsStyle pop-in" name="notifications">
      <span *ngIf="notificationCount != 0">
        <ion-badge class="pull-right" class="icon-badge">{{notificationCount}}</ion-badge>
      </span>
    </ion-icon>
  </div> -->


  <ion-title style="width: 66vw; position: relative; top: 20px; left: 10vw;">
    <span style="font-size: 17px;color: white; font-weight: bold">Mes contacts</span>
  </ion-title>
</ion-header>

<ion-content padding>
  <div class="row" [ngStyle]="{'margin-top': topList, 'text-align': 'center'}">
    <ion-col (click)="selectContactList()" [ngStyle]="{'border-bottom': myContactBorder}" col-6>
      Mes Habee'Nautes
    </ion-col>
    <ion-col (click)="selectInvitationList()" [ngStyle]="{'border-bottom': listInvitBorder}" col-6>
      En attente
      <span *ngIf="notificationCount != 0">
        <ion-badge class="icon-badge">{{notificationCount}}</ion-badge>
      </span>
    </ion-col>
  </div>



  <ion-list [ngStyle]="{'display': myContactBorderDisplay}">
    <ion-item-sliding *ngFor='let user of contact'>

      <ion-item no-lines>
        <ion-avatar item-left>
          <img [src]='url + "/" + user.profilePhoto'>
        </ion-avatar>
        
        <h2>{{user.profileUsername}}</h2>
        <span *ngFor='let community of user.communities'>
                <img style="width: 12%;
                height: 12%; border-radius: 100%" [src]='url + "/" + community.communityLogo'>
        </span>

        <button *ngIf="user.userId == tabParams.userId" ion-button clear item-end>
          <ion-badge class="pull-right" color="danger">moi</ion-badge>
        </button>
      </ion-item>

      <ion-item-options side="right">
        <!-- <button style="position: relative; width: 100px" ion-button color="primary" (click)="viewEventDetails(item)">
                    <ion-icon name="eye"></ion-icon>
                    Voir
                  </button> -->
     
                  <button class="pop-in" [ngClass]="{ 'expand' : expanded, 'contract': contracted }"
          style="position: relative; width: 50px; background-color: #e11d6f;" ion-button>
          <ion-icon style="font-size: 32px;font-weight: bold; color: white; border-radius: 100%" name="remove"></ion-icon>
        </button>

        <button (click)="addComToContact($event)"  class="pop-in" [ngClass]="{ 'expand' : expanded, 'contract': contracted }"
          style="position: relative; width: 50px; background-color: #77ad35;" ion-button>
          <ion-icon style="font-size: 32px;font-weight: bold; color: white; border-radius: 100%" name="add"></ion-icon>
        </button>
     
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>


  <ion-list [ngStyle]="{'display': listInvitBorderDisplay}" *ngFor="let invit of invitationList">

          <ion-item *ngIf="invit.invitatorId == tabParams.userId && invit.contactExist == false
          && invit.status == 'pending'">
            <ion-item no-lines>
              <p><b>Vous avez invité</b> {{invit.invitedEmail}} <b>pour rejoindre la communaute {{invit.InvitationCommunitName}}</b></p>
            </ion-item>
            <ion-item style="margin-top: -17px">
              <p>{{transform(invit.dateOfCreation)}}
                <ion-badge class="pull-right" style="float:right; background-color: darkorange" slot="end">pending...</ion-badge>
              </p>
            </ion-item>
          </ion-item>
  
          <ion-item *ngIf="invit.invitatorId == tabParams.userId && invit.contactExist == true
          && invit.status == 'pending'">
            <ion-item no-lines>
              <p><b>Vous avez invité</b> {{invit.invitedFullname}} <b>pour rejoindre la communaute {{invit.InvitationCommunitName}}</b></p>
            </ion-item>
            <ion-item style="margin-top: -17px">
              <p>{{transform(invit.dateOfCreation)}}
                <ion-badge class="pull-right" style="float:right; background-color: darkorange" slot="end">pending...</ion-badge>
              </p>
            </ion-item>
          </ion-item>
  
          <ion-item *ngIf="invit.invitatorId != tabParams.userId && invit.invitedId == tabParams.userId
          && invit.contactExist == true && invit.status == 'pending'">
            <ion-item>
              <p><b>Vous avez été invité par </b> {{invit.invitorFullname}} <b>pour rejoindre la communaute {{invit.InvitationCommunitName}}</b></p>
            </ion-item>
            <ion-item style="margin-top: -17px">
              <p>{{transform(invit.dateOfCreation)}}
              </p>
              <button ion-button (click)="rejectInvitation(invit)" class="pull-right" style="float:right;" color="danger" slot="end">rejeter</button>
              <button ion-button (click)="acceptInvitation(invit)" class="pull-right" style="float:right;" color="primary"
                slot="end">accepter</button>
              
            </ion-item>
          </ion-item>
  
          <ion-item *ngIf="invit.invitatorId == tabParams.userId && invit.contactExist == true 
          && invit.status == 'accepted' ">
            <ion-item>
              <p>{{invit.invitedFullname}} <b>a accepté votre invitation pour rejoindre la communaute {{invit.InvitationCommunitName}}.</b></p>
            </ion-item>
  
            <ion-item style="margin-top: -17px">
              <p>{{transform(invit.dateOfCreation)}}
                <ion-badge class="pull-right" style="float:right; background-color: green" slot="end">accpte</ion-badge>
              </p>
            </ion-item>
  
          </ion-item>
  
  
          <ion-item *ngIf="invit.invitatorId == tabParams.userId && invit.contactExist == true
          && invit.status == 'rejected' ">
            <ion-item text-wrap>
              <p>{{invit.invitedFullname}} <b>a rejeté votre invitation pour rejoindre la communaute {{invit.InvitationCommunitName}}.</b></p>
            </ion-item>
            <ion-item style="margin-top: -17px">
              <p>{{transform(invit.dateOfCreation)}}
                  <ion-badge class="pull-right" style="float:right; background-color: green" slot="end">rejete</ion-badge>
              </p>
            </ion-item>
  
          </ion-item>
  </ion-list>


  <ion-infinite-scroll (ionInfinite)="doInfinite($event)" *ngIf="page < totalPage">
    <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>

</ion-content>

<ion-footer>
  <ion-fab style="margin-bottom: 16vw" bottom right mini #fab>
    <button ion-fab style="background-color: darkgray;" mini>
      <ion-icon name="add"></ion-icon>
    </button>
    <ion-fab-list side="top">
      <button ion-fab mini (click)="scanBrCode()">
        <ion-icon name="qr-scanner"></ion-icon>
      </button>
      <button ion-fab mini (click)="encodeData()">
        <ion-icon name="barcode"></ion-icon>
      </button>
      <button ion-fab mini (click)="expand()">
        <ion-icon name="person-add"></ion-icon>
      </button>
    </ion-fab-list>
  </ion-fab>
</ion-footer>
